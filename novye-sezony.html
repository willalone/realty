<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ЖК Новые сезоны - Проект завершен</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="novye-sezony">
    <!-- Header -->
    <header class="site-header">
        <div class="header-inner">
            <div class="logo">
                <a href="index.html">
                    <span class="logo-text">СК НВМ</span>
                </a>
            </div>
            <button class="nav-toggle" onclick="toggleNav()" aria-label="Открыть меню">
                <span class="nav-toggle-bar"></span>
            </button>
            <nav class="nav" id="nav">
                <a href="index.html#projects" class="nav-link">Проекты</a>
                <a href="index.html#mortgage" class="nav-link">Ипотека</a>
                <a href="index.html#promos" class="nav-link">Акции</a>
            </nav>
            <div class="header-actions">
                <a href="tel:+78612112850" class="phone">+7(988)470-78-93</a>
                <button class="btn btn-primary" onclick="openModal('consultation')">Обратный звонок</button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="project-hero">
        <div class="hero-video">
            <img src="img/dom-101.webp" alt="ЖК Новые сезоны" style="width: 100%; height: 100%; object-fit: cover;">
            <div class="video-overlay"></div>
        </div>
        <div class="container">
            <div class="breadcrumbs">
                <a href="index.html">Главная</a> / <a href="index.html#projects">Проекты</a> / <span>ЖК Новые сезоны</span>
            </div>
            <div class="project-hero-content">
                <div class="project-info">
                    <div class="project-date">Проект завершен</div>
                    <div class="project-status-badges">
                        <span class="badge badge-primary">Сдан в 2024</span>
                    </div>
                    <h1>ЖК Новые сезоны</h1>
                    <h2 class="project-subtitle">Идеальный дом для всех сезонов жизни</h2>
                    <div class="hero-cta">
                        <button class="btn btn-primary btn-large" onclick="openModal('consultation')">Связаться с нами</button>
                    </div>
                </div>
                <div class="project-features">
                    <div class="feature-highlight">
                        <h3>2240+</h3>
                        <p>квартир в комплексе</p>
                    </div>
                    <div class="feature-highlight">
                        <h3>2024</h3>
                        <p>год сдачи проекта</p>
                    </div>
                    <div class="feature-highlight">
                        <h3>14</h3>
                        <p>девятиэтажных жилых домов</p>
                    </div>
                    <div class="feature-highlight">
                        <h3>15</h3>
                        <p>жилых корпусов</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Project Details -->
    <section class="project-details">
        <div class="container">
            <h2>О проекте</h2>
            <p>«Новые Сезоны» — жилой комплекс комфорт-класса на западе Краснодара. Включает 15 жилых корпусов и собственную инфраструктуру: детские сады, школу, парки и торговый центр. Для автомобилистов предусмотрены подземные и наземные паркинги. Дворы оборудованы спортивными и детскими площадками, есть зоны отдыха. Ввод в эксплуатацию произведен в апреле 2024 года.</p>
        </div>
        
        <div class="project-banner-full">
            <img src="src/img/новые сезоны/banner.png" alt="ЖК Новые сезоны" class="banner-image-full">
        </div>
    </section>

    <!-- Advantages Section -->
    <section class="advantages-section">
        <div class="container">
            <h2>Преимущества</h2>
            <div class="project-sections-grid">
                <div class="project-section-card">
                    <div class="section-image">
                        <img src="src/img/новые сезоны/spirt-detsk-ploshadki.png" alt="Спортивные и детские площадки">
                    </div>
                    <div class="section-content">
                        <h3>Спортивные и детские площадки</h3>
                        <p>Современные площадки для активного отдыха всей семьи. Безопасные игровые зоны для детей и спортивные площадки для взрослых.</p>
                    </div>
                </div>
                
                <div class="project-section-card">
                    <div class="section-image">
                        <img src="src/img/новые сезоны/naz-parking.png" alt="Многоуровневый наземный паркинг">
                    </div>
                    <div class="section-content">
                        <h3>Многоуровневый наземный паркинг</h3>
                        <p>Удобная парковка для всех жителей комплекса. Многоуровневый наземный паркинг с достаточным количеством мест.</p>
                    </div>
                </div>
                
                <div class="project-section-card">
                    <div class="section-image">
                        <img src="src/img/новые сезоны/terrotoriya.png" alt="Благоустроенная территория">
                    </div>
                    <div class="section-content">
                        <h3>Благоустроенная территория</h3>
                        <p>Уютный двор, закрытый от городского шума. Современное благоустройство с зелеными зонами и местами для отдыха.</p>
                    </div>
                </div>
                
                <div class="project-section-card">
                    <div class="section-image">
                        <img src="src/img/новые сезоны/planirovki.png" alt="Удобные планировки">
                    </div>
                    <div class="section-content">
                        <h3>Удобные планировки</h3>
                        <p>Продуманные планировки от студий до 3-комнатных квартир. Функциональные решения для комфортного проживания.</p>
                    </div>
                </div>
                
                <div class="project-section-card">
                    <div class="section-image">
                        <img src="src/img/новые сезоны/otdelka.png" alt="Предчистовая отделка">
                    </div>
                    <div class="section-content">
                        <h3>Предчистовая отделка</h3>
                        <p>Качественная предчистовая отделка во всех квартирах. Готовность к финальному ремонту и заселению.</p>
                    </div>
                </div>
                
                <div class="project-section-card">
                    <div class="section-image">
                        <img src="src/img/новые сезоны/dvor.png" alt="Уютный двор">
                    </div>
                    <div class="section-content">
                        <h3>Уютный двор, закрытый от городского шума</h3>
                        <p>Тихая и спокойная атмосфера для комфортного проживания. Закрытая территория с контролируемым доступом.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- Spacing at the end -->
    <div style="height: 80px;"></div>

    <!-- Modal -->
    <div id="modal" class="modal-backdrop" style="display: none;" onclick="closeModal()">
        <div class="modal-dialog" onclick="event.stopPropagation()">
            <div class="modal-content">
                <button class="modal-close" onclick="closeModal()">&times;</button>
                <div id="modal-body"></div>
            </div>
        </div>
    </div>

    <script>
        // Telegram config
        const TG_BOT_TOKEN = (window && window.TELEGRAM_BOT_TOKEN) ? window.TELEGRAM_BOT_TOKEN : '8026350498:AAGcyKMsrJyD0mGgj26Ss2m49vX5jp8LzaM';
        const TG_CHAT_ID = (window && window.TELEGRAM_CHAT_ID) ? window.TELEGRAM_CHAT_ID : '919481169';

        function openModal(modalId) {
            console.log('openModal called with:', modalId);
            const modal = document.getElementById('modal');
            const modalBody = document.getElementById('modal-body');
            modalBody.innerHTML = getModalContent(modalId);
            modal.style.display = 'flex';
            document.body.classList.add('modal-open');
            
            // Initialize phone masks for newly created modal content
            initPhoneMasks();
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            document.body.classList.remove('modal-open');
        }

        function getModalContent(modalId) {
            const modalContents = {
                'consultation': `
                    <h3>Получить консультацию</h3>
                    <p>Оставьте свои данные, и мы свяжемся с вами в ближайшее время.</p>
                    <form class="consultation-form" onsubmit="handleConsultationSubmit(event)">
                        <div class="form-group">
                            <input type="text" name="name" placeholder="Ваше имя" required>
                        </div>
                        <div class="form-group">
                            <input type="tel" name="phone" placeholder="+7(___)___-__-__" required>
                        </div>
                        <div class="form-checkbox">
                            <input type="checkbox" id="privacy-modal" required>
                            <label for="privacy-modal">Я соглашаюсь с политикой конфиденциальности сайта</label>
                        </div>
                        <button type="submit" class="btn btn-primary">Отправить заявку</button>
                    </form>
                `
            };
            return modalContents[modalId] || '<p>Содержимое не найдено.</p>';
        }

        function handleConsultationSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const name = form.querySelector('input[name="name"]').value.trim();
            const phone = form.querySelector('input[name="phone"]').value.trim();
            const privacyCheckbox = form.querySelector('input[type="checkbox"]');

            // Validate name - only letters, minimum 2 characters
            const nameRegex = /^[a-zA-Zа-яА-ЯёЁ\s\-']+$/;
            if (!name || !nameRegex.test(name)) {
                showToast('Имя должно содержать только буквы и быть не менее 2 символов', 'error');
                return;
            }

            if (name.length < 2) {
                showToast('Имя должно содержать не менее 2 символов', 'error');
                return;
            }

            if (!phone) {
                showToast('Пожалуйста, заполните номер телефона', 'error');
                return;
            }

            const phoneDigits = phone.replace(/\D/g, '');
            if (phoneDigits.length !== 11) {
                showToast('Введите корректный номер телефона в формате +7(999)999-99-99', 'error');
                return;
            }

            if (privacyCheckbox && !privacyCheckbox.checked) {
                showToast('Пожалуйста, согласитесь с политикой конфиденциальности', 'error');
                return;
            }

            sendConsultationToTelegram({ name, phone });
            closeModal();
        }

        function sendConsultationToTelegram(formData) {
            const botToken = TG_BOT_TOKEN;
            const chatId = TG_CHAT_ID;
            const message = `📝 Новая заявка на консультацию
            
👤 Имя: ${formData.name}
📞 Телефон: ${formData.phone}`;

            fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: message,
                    parse_mode: 'HTML'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    showToast('Заявка успешно отправлена! Мы свяжемся с вами в ближайшее время.', 'success');
                    closeModal();
                } else {
                    console.error('Telegram API error:', data);
                    showToast('Ошибка при отправке заявки. Попробуйте еще раз.', 'error');
                }
            })
            .catch(error => {
                console.error('Network error:', error);
                showToast('Ошибка сети при отправке заявки. Попробуйте еще раз.', 'error');
            });
        }

        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<div class="toast-content">${message}</div><button class="toast-close" aria-label="Закрыть">×</button>`;
            document.body.appendChild(toast);

            toast.querySelector('.toast-close').addEventListener('click', () => {
                toast.remove();
            });

            setTimeout(() => {
                toast.remove();
            }, 5000);
        }

        // Phone number formatting functions
        function formatPhoneNumber(event) {
            let value = event.target.value.replace(/\D/g, '');
            
            // Limit to 11 digits maximum
            if (value.length > 11) {
                value = value.slice(0, 11);
                event.target.value = formatPhoneValue(value);
                return;
            }
            
            if (value.length === 0) {
                event.target.value = '';
                return;
            }
            
            event.target.value = formatPhoneValue(value);
        }

        function formatPhoneValue(value) {
            if (value.length === 0) return '';
            
            if (value.length <= 1) {
                return '+7(' + value;
            } else if (value.length <= 4) {
                return '+7(' + value.slice(1);
            } else if (value.length <= 7) {
                return '+7(' + value.slice(1, 4) + ')' + value.slice(4);
            } else if (value.length <= 9) {
                return '+7(' + value.slice(1, 4) + ')' + value.slice(4, 7) + '-' + value.slice(7);
            } else {
                return '+7(' + value.slice(1, 4) + ')' + value.slice(4, 7) + '-' + value.slice(7, 9) + '-' + value.slice(9, 11);
            }
        }

        function handlePhoneKeydown(event) {
            // Allow: backspace, delete, tab, escape, enter, home, end, left, right, up, down
            if ([8, 9, 27, 13, 46, 35, 36, 37, 38, 39, 40].indexOf(event.keyCode) !== -1 ||
                // Allow Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
                (event.keyCode === 65 && event.ctrlKey === true) ||
                (event.keyCode === 67 && event.ctrlKey === true) ||
                (event.keyCode === 86 && event.ctrlKey === true) ||
                (event.keyCode === 88 && event.ctrlKey === true)) {
                return;
            }
            
            // Ensure that it is a number and stop the keypress
            if ((event.shiftKey || (event.keyCode < 48 || event.keyCode > 57)) && (event.keyCode < 96 || event.keyCode > 105)) {
                event.preventDefault();
            }
        }

        function formatNameInput(event) {
            let value = event.target.value;
            // Remove numbers and special characters, keep only letters, spaces, hyphens, and apostrophes
            value = value.replace(/[^a-zA-Zа-яА-ЯёЁ\s\-']/g, '');
            event.target.value = value;
        }

        function handleNameKeydown(event) {
            // Allow: backspace, delete, tab, escape, enter, home, end, left, right, up, down, space, hyphen, apostrophe
            if ([8, 9, 27, 13, 46, 35, 36, 37, 38, 39, 40, 32, 189, 222].indexOf(event.keyCode) !== -1 ||
                // Allow Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
                (event.keyCode === 65 && event.ctrlKey === true) ||
                (event.keyCode === 67 && event.ctrlKey === true) ||
                (event.keyCode === 86 && event.ctrlKey === true) ||
                (event.keyCode === 88 && event.ctrlKey === true)) {
                return;
            }
            
            // Allow letters (both cases), spaces, hyphens, apostrophes
            if ((event.keyCode >= 65 && event.keyCode <= 90) || // A-Z
                (event.keyCode >= 97 && event.keyCode <= 122) || // a-z
                (event.keyCode >= 1040 && event.keyCode <= 1103) || // Cyrillic
                event.keyCode === 32 || // space
                event.keyCode === 189 || // hyphen
                event.keyCode === 222) { // apostrophe
                return;
            }
            
            event.preventDefault();
        }

        // Initialize phone masks and name validation for all inputs
        function initPhoneMasks() {
            // Find all phone inputs
            const phoneInputs = document.querySelectorAll('input[type="tel"], input[name="phone"]');
            
            phoneInputs.forEach(input => {
                // Add event listeners
                input.addEventListener('input', formatPhoneNumber);
                input.addEventListener('keydown', handlePhoneKeydown);
                input.setAttribute('maxlength', '17'); // ensure max length mask
                input.addEventListener('paste', function(e) {
                    // Allow paste, but format after paste
                    setTimeout(() => {
                        formatPhoneNumber({ target: input });
                    }, 10);
                });
            });

            // Find all name inputs and add validation
            const nameInputs = document.querySelectorAll('input[name="name"]');
            nameInputs.forEach(input => {
                input.addEventListener('input', formatNameInput);
                input.addEventListener('keydown', handleNameKeydown);
                input.addEventListener('paste', function(e) {
                    setTimeout(() => {
                        formatNameInput({ target: input });
                    }, 10);
                });
            });
        }

        function toggleNav() {
            const nav = document.getElementById('nav');
            nav.classList.toggle('show');
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing...');
            try {
                initPhoneMasks();
                console.log('Initialization completed successfully');
            } catch (error) {
                console.error('Initialization error:', error);
            }
        });
    </script>
</body>
</html>
